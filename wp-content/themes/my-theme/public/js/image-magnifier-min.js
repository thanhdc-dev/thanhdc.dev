var imageZoom=function(i,t,e){for(var d=["blur","inner","tint"],h=0;h<3;h++)void 0===i[d[h]]&&(i[d[h]]=!1);var s={background:"background-image : url('"+e.src.replace(/\'/g,"\\'")+"');","background-large":"background-image : url('"+t.src.replace(/\'/g,"\\'")+"');",dimensions:"height : "+e.height+"px; width : "+e.width+"px;"},n=t.height/e.height,o=t.width/e.width;s.thumbnail=s.background+" "+s.dimensions,i.inner?(document.write('<div class="image-zoom inner"><div class="thumbnail" rel="'+t.width+"-"+t.height+"_"+e.width+"-"+e.height+'_4" style="'+s.thumbnail+'"><div class="popup" style="'+s["background-large"]+" "+s.dimensions+'"></div></div></div>'),$("div.image-zoom:last div.popup").fadeTo(0,0),$("div.image-zoom:last div.thumbnail").mouseenter(function(i){$(this).children("div.popup").fadeTo(333,1)}).mouseleave(function(){$(this).children("div.popup").fadeTo(333,0)}).mousemove(function(i){var t=$(this).attr("rel").split(/_/),e=$(this).offset();t[0]=t[0].split(/\-/),t[1]=t[1].split(/\-/),t[2]=parseInt(t[2],10);var d=parseInt(t[0][1],10)/parseInt(t[1][1],10),h=parseInt(t[0][0],10)/parseInt(t[1][0],10),s=i.pageX-e.left-t[2],n=i.pageY-e.top-t[2];s<0&&(s=0),s>t[1][0]&&(s=t[1][0]),n<0&&(n=0),n>t[1][1]&&(n=t[1][1]),$(this).children("div.popup").css("background-position",(s>0?"-"+(s*h-t[1][0]*s/t[1][0])+"px":0)+" "+(n>0?"-"+(n*d-t[1][1]*n/t[1][1])+"px":0))})):(document.write('<div class="image-zoom'+(i.blur?" blur":"")+(i.tint?" tint":"")+'"><div class="thumbnail" style="'+s.thumbnail+'">'+(i.blur?'<div class="blur"><div style="'+s.thumbnail+'"><div style="'+s.thumbnail+'"><div style="'+s.thumbnail+'"><div style="'+s.thumbnail+'">':"")+(i.tint?'<div class="tint" style="background-color : '+i.tint+"; "+s.dimensions+'">':"")+(i.tint?"</div>":"")+(i.blur?"</div></div></div></div></div>":"")+'<div class="box" style="'+s.background+" height : "+Math.round(e.height/n)+"px; top : -"+e.height+"px; width : "+Math.round(e.width/o)+'px;"></div></div><div class="popup" rel="'+t.width+"x"+t.height+"/"+e.width+"x"+e.height+'/4" style="'+s["background-large"]+" margin-right : -"+(e.width+4)+"px; margin-bottom : -"+(e.height+4)+"px; "+s.dimensions+'"></div></div>'),$("div.image-zoom:last div.blur div, div.image-zoom:last div.box, div.image-zoom:last div.tint, div.image-zoom:last div.popup").fadeTo(0,0),$("div.image-zoom:last div.thumbnail").mouseenter(function(){$(this).children("div.box").fadeTo(333,1),$(this).find("div.tint").fadeTo(333,.5),$(this).find("div.blur div:not(div.tint)").fadeTo(333,.8),$(this).parent().children("div.popup").css("display","block").fadeTo(333,1)}).mouseleave(function(){$(this).children("div.box").fadeTo(333,0),$(this).find("div.tint").fadeTo(333,0),$(this).find("div.blur div").fadeTo(333,0),$(this).parent().children("div.popup").css("display","none").fadeTo(333,0)}).mousemove(function(i){var t=$(this).parent().children("div.popup").attr("rel").split(/\//),e=$(this).parent().offset();t[0]=t[0].split(/x/),t[1]=t[1].split(/x/),t[2]=parseInt(t[2],10);var d=parseInt(t[0][1],10)/parseInt(t[1][1],10),h=parseInt(t[0][0],10)/parseInt(t[1][0],10),s=i.pageX-e.left,n=i.pageY-e.top;s-=$(this).width()/h/2,n-=$(this).height()/d/2,s<0&&(s=0),s>$(this).width()-$(this).width()/h&&(s=$(this).width()-$(this).width()/h),n<0&&(n=0),n>$(this).height()-$(this).height()/d&&(n=$(this).height()-$(this).height()/d),s=Math.round(s),n=Math.round(n-$(this).height()-t[2]),$(this).children("div.box").css({backgroundPosition:(s>0?"-"+s+"px":0)+" "+(n>0-$(this).height()-t[2]?"-"+(n+$(this).height()+t[2])+"px":0),left:s-t[2]+"px",top:n+"px"}),$(this).parent().children("div.popup").css("background-position",(s>0?"-"+(s*h-1)+"px":0)+" "+(n>0-$(this).height()-t[2]?"-"+((n+$(this).height()+t[2])*h-1)+"px":0))}))};